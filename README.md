# PocketExportToMarkdownWithSimpreadAtChrome

这是一个使用Python和Selenium编写的脚本，用于自动化处理一系列网页操作。它可以按顺序打开`todo.txt`文件中的网址，检查网页是否正确加载，然后模拟键盘操作以调用Chrome插件。如果网页的网址有变化，或者打开网页失败，脚本会关闭网页，并将网址存储到`error.txt`文件中。每完成20次操作后，脚本会暂停。

## 技术栈

- Python
- Selenium
- ChromeDriver

## 如何使用

1. 安装Python和Selenium。
2. 下载并设置ChromeDriver。
3. 安装并配置好Simpread插件，设置进入阅读模式快捷键为`a a`，保存快捷键为`a t`。
4. 将想要处理的网址复制到`todo.txt`文件中，每行一个网址。
5. 运行脚本，脚本会自动打开Chrome，读取`todo.txt`中的网址，选取前20个网址，逐个打开，每个间隔5秒。
6. 一分钟后，脚本开始对每个网页进行操作。如果网页的网址是原有的网址，脚本会执行键盘操作`a a`，等待五秒，然后执行`a t`，并保留网页为打开状态。如果网页的网址有变化，或者打开网页失败，脚本会关闭网页，并将网址记录到`error.txt`中。
7. 20个网页执行完毕后，脚本暂停，弹窗显示网页，提示用户查看网页是否正确保存，提示用户使用`ctrl + w`快捷关闭网页。

## 注意事项

- 请确保您的网速足够快，以便网页能够在预设的延迟时间内完全加载。
- 请确保您的Chrome插件可以通过键盘操作调用。
- 请确保`todo.txt`文件中的网址格式正确。

## 理想的情景

- 打开导出的pocket列表, 手动复制想要处理的文件到本地文件`todo.txt`
- `todo.txt` 应该是一个纯文本文件，每行一个网址, that's all
- 安装并配置好Simpread插件, 假设进入阅读模式快捷键为键盘的`a a`, 保存快捷键为`a t`
- 运行脚本
    - 这个项目, 会自动打开Chrome, 读取`todo.txt`中的网址, 选取前20个网址
    - 逐个打开, 每个间隔5秒.
    - 一分钟后, 到第一个网页, 开始操作
    - if 网页的网址是原有的网址
        - 执行键盘操作`a a`
        - 等待五秒
        - 执行`a t`
        - 保留网页为打开状态
    - elseif 网页的网址有变化, 或者打开网页失败
        - 关闭网页
        - 将网址记录到`error.txt`中
    - 进入下一个网页, 重复上述的if elseif操作
- 20个网页执行完毕后, 脚本暂停
- 弹窗显示网页
- 提示用户: 查看网页是否正确保存
- 提示用户: 使用`ctrl + w`快捷关闭网页
